<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>컴퓨터 하드웨어 점검 내역서</title>
    <style>
        /* A4 용지 기본 설정 */
        @page {
            size: A4;
            margin: 0;
        }
        
        body {
            font-family: 'Malgun Gothic', sans-serif;
            line-height: 1.4;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            font-size: 12px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        h1, h2 {
            color: #333;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .form-section {
            margin-bottom: 15px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
        }
        
        .hardware-item {
            margin-bottom: 8px;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .hardware-item label {
            display: block;
            margin-bottom: 3px;
            font-weight: bold;
        }
        
        .hardware-details {
            margin-left: 20px;
            margin-top: 3px;
            display: none;
        }
        
        input[type="checkbox"] {
            margin-right: 6px;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 12px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
            width: 100%;
        }
        
        .select-all-btn {
            background-color: #2196F3;
            margin-bottom: 10px;
        }
        
        .customer-input-section {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .customer-input-section label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .customer-input-section input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        /* 인쇄용 A4 크기 설정 */
        .report-container {
            display: none;
            width: 210mm;
            min-height: 297mm;
            height: auto;
            margin: 0 auto;
            background: white;
            padding: 15mm;
            box-sizing: border-box;
            position: relative;
        }
        
        .report-content {
            min-height: 267mm; /* 297mm - 30mm 패딩 */
            display: flex;
            flex-direction: column;
        }
        
        .report-title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            letter-spacing: 10px;
            padding-left: 10px;
        }
        
        .business-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
        }
        
        .customer-info {
            margin-bottom: 15px;
            position: relative;
        }
        
        .report-items {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 11px;
        }
        
        .report-items th, .report-items td {
            border: 1px solid #ddd;
            padding: 5px;
            white-space: nowrap;
            vertical-align: middle; /* 수직 가운데 정렬 */
        }
        
        .report-items th {
            background-color: #f2f2f2;
            text-align: center;
            font-size: 11px;
            padding: 6px 4px;
        }
        
        .report-items td {
            font-size: 11px;
        }
        
        .report-items td:nth-child(2) {
            white-space: normal;
        }
        
        .report-items td:first-child, .report-items td:last-child {
            text-align: center; /* 가로 가운데 정렬 */
        }
        
        .table-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .empty-space {
            flex-grow: 1;
            min-height: 20px;
            border-top: 1px dashed #eee;
            border-bottom: 1px dashed #eee;
            margin: 10px 0;
        }
        
        .tax-info {
            margin-top: auto;
            border-top: 1px solid #ddd;
            padding-top: 8px;
        }
        
        .tax-info table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .tax-info th, .tax-info td {
            padding: 4px;
            text-align: right;
            border: none;
            white-space: nowrap;
            font-size: 11px;
            vertical-align: middle; /* 수직 가운데 정렬 */
        }
        
        .account-info {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
            font-size: 11px;
            text-align: center;
        }
        
        .account-info p {
            margin: 5px 0;
        }
        
        .account-number {
            font-weight: bold;
            font-size: 12px;
        }
        
        .footer-info {
            margin-top: auto;
        }
        
        .stamp {
            text-align: right;
            margin-top: 20px;
            position: relative;
        }
        
        .stamp p {
            margin: 5px 0;
        }
        
        .official-seal {
            width: 50px;
            height: 50px;
            position: absolute;
            top: -15px;
            right: 10px;
        }
        
        .business-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 11px;
        }
        
        .business-table th, .business-table td {
            border: 1px solid #ddd;
            padding: 5px;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle; /* 수직 가운데 정렬 */
        }
        
        .business-table th {
            background-color: #f2f2f2;
            width: 15%;
        }
        
        .date-section {
            margin-bottom: 15px;
        }
        
        .representative-cell {
            position: relative;
            padding-right: 60px !important;
        }
        
        .detail-item {
            display: block;
            margin-bottom: 3px;
            text-indent: -8px;
            padding-left: 8px;
            font-size: 10px;
            line-height: 1.3;
        }
        
        .save-button {
            background-color: #2196F3;
            margin-top: 15px;
        }
        
        @media print {
            html, body {
                width: 210mm;
                height: 297mm;
                margin: 0;
                padding: 0;
            }
            
            .container {
                display: none;
            }
            
            .report-container {
                display: block !important;
                padding: 10mm;
                margin: 0;
                border: none;
                box-shadow: none;
                width: 190mm;
                height: 277mm;
                page-break-after: always;
            }
            
            .save-button {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>컴퓨터 하드웨어 점검 내역서 생성</h1>
        <p>점검할 항목을 선택하시면 점검 내역서가 자동으로 생성됩니다.</p>
        
        <div class="customer-input-section">
            <label for="customer-input">고객명:</label>
            <input type="text" id="customer-input" placeholder="고객명을 입력하세요">
            
            <label for="date-input">점검일:</label>
            <input type="date" id="date-input">
        </div>
        
        <button class="select-all-btn" onclick="selectAllItems(true)">전체 항목 선택</button>
        <button class="select-all-btn" onclick="selectAllItems(false)" style="background-color: #f44336;">전체 항목 해제</button>
        
        <div class="form-section">
            <div class="hardware-item">
                <label><input type="checkbox" id="visit-check"> 출장비 (20,000원)</label>
            </div>
            
            <div class="hardware-item">
                <label><input type="checkbox" id="cpu-check" onclick="toggleDetails('cpu-details'); checkAllSubItems('cpu-items', this.checked)"> CPU Performance Check (10,000원)</label>
                <div id="cpu-details" class="hardware-details">
                    <label><input type="checkbox" name="cpu-items" value="10000"> CPU Temperature 측정 및 Thermal throttling 확인</label><br>
                    <label><input type="checkbox" name="cpu-items" value="0"> Basic performance benchmark 테스트</label><br>
                    <label><input type="checkbox" name="cpu-items" value="0"> CPU Fan 작동 상태 및 RPM 확인</label><br>
                    <label><input type="checkbox" name="cpu-items" value="0"> Clock speed 정상 동작 확인</label><br>
                </div>
            </div>
            
            <div class="hardware-item">
                <label><input type="checkbox" id="mb-check" onclick="toggleDetails('mb-details'); checkAllSubItems('mb-items', this.checked)"> Motherboard Diagnostics (10,000원)</label>
                <div id="mb-details" class="hardware-details">
                    <label><input type="checkbox" name="mb-items" value="10000"> Power delivery 안정성 및 POST 테스트</label><br>
                    <label><input type="checkbox" name="mb-items" value="0"> Main slots(RAM, PCIe, SATA) connectivity 확인</label><br>
                    <label><input type="checkbox" name="mb-items" value="0"> BIOS/UEFI settings 점검</label><br>
                    <label><input type="checkbox" name="mb-items" value="0"> Board damage & capacitor status 확인</label><br>
                </div>
            </div>
            
            <div class="hardware-item">
                <label><input type="checkbox" id="ram-check" onclick="toggleDetails('ram-details'); checkAllSubItems('ram-items', this.checked)"> Memory (RAM) Testing (10,000원)</label>
                <div id="ram-details" class="hardware-details">
                    <label><input type="checkbox" name="ram-items" value="10000"> RAM recognition & capacity verification</label><br>
                    <label><input type="checkbox" name="ram-items" value="0"> Memory error diagnostics</label><br>
                    <label><input type="checkbox" name="ram-items" value="0"> Compatibility & dual-channel 구성 점검</label><br>
                    <label><input type="checkbox" name="ram-items" value="0"> Stability testing under load</label><br>
                </div>
            </div>
            
            <div class="hardware-item">
                <label><input type="checkbox" id="psu-check" onclick="toggleDetails('psu-details'); checkAllSubItems('psu-items', this.checked)"> Power Supply Unit Check (10,000원)</label>
                <div id="psu-details" class="hardware-details">
                    <label><input type="checkbox" name="psu-items" value="10000"> Power stability & output testing</label><br>
                    <label><input type="checkbox" name="psu-items" value="0"> Voltage rails (12V, 5V, 3.3V) 확인</label><br>
                    <label><input type="checkbox" name="psu-items" value="0"> Cable & connector inspection</label><br>
                    <label><input type="checkbox" name="psu-items" value="0"> Efficiency under load 테스트</label><br>
                </div>
            </div>
            
            <div class="hardware-item">
                <label><input type="checkbox" id="gpu-check" onclick="toggleDetails('gpu-details'); checkAllSubItems('gpu-items', this.checked)"> Graphics & Display Output Testing (10,000원)</label>
                <div id="gpu-details" class="hardware-details">
                    <label><input type="checkbox" name="gpu-items" value="10000"> GPU recognition & driver status check</label><br>
                    <label><input type="checkbox" name="gpu-items" value="0"> Resolution & output ports 테스트</label><br>
                    <label><input type="checkbox" name="gpu-items" value="0"> Graphics performance benchmark</label><br>
                    <label><input type="checkbox" name="gpu-items" value="0"> Multi-display compatibility 점검</label><br>
                    <label><input type="checkbox" name="gpu-items" value="0"> Display quality & refresh rate 확인</label><br>
                </div>
            </div>
        </div>
        
        <button onclick="generateReport()">점검 내역서 생성하기</button>
    </div>
    
    <div id="report-result" class="report-container">
        <div class="report-content">
            <div class="report-title">점검내역서</div>
            
            <div class="business-table-container">
                <table class="business-table">
                    <tr>
                        <th>등록번호</th>
                        <td colspan="3">876-13-01105</td>
                    </tr>
                    <tr>
                        <th>상 호</th>
                        <td>웰컴 노트북수리</td>
                        <th>대표자</th>
                        <td class="representative-cell">남 태웅
                            <img id="seal-image" class="official-seal" alt="도장" src="https://themeg2.github.io/comdoctor_-statement/dojang.png">
                        </td>
                    </tr>
                    <tr>
                        <th>주 소</th>
                        <td colspan="3">동래구 명장동 시실로 211번길 38</td>
                    </tr>
                    <tr>
                        <th>업 태</th>
                        <td>서비스/소매</td>
                        <th>종 목</th>
                        <td>컴퓨터수리 및 판매</td>
                    </tr>
                    <tr>
                        <th>전 화</th>
                        <td colspan="3">070-7642-7624</td>
                    </tr>
                </table>
            </div>
            
            <div class="customer-info">
                <p><strong>점검일:</strong> <span id="current-date">2025년 3월 31일</span></p>
                <p><strong>고객명:</strong> <span id="customer-name">홍길동</span> 님</p>
            </div>
            
            <div class="table-container">
                <table class="report-items">
                    <thead>
                        <tr>
                            <th width="25%">점검 항목</th>
                            <th width="55%">세부 내용</th>
                            <th width="20%">금액</th>
                        </tr>
                    </thead>
                    <tbody id="report-items-body">
                        <!-- 여기에 동적으로 항목이 추가됩니다 -->
                    </tbody>
                </table>
                
                <!-- 항목이 적을 때 빈 공간을 채워주는 div -->
                <div class="empty-space" id="empty-space"></div>
            </div>
            
            <div class="footer-info">
                <div class="tax-info">
                    <table>
                        <tr>
                            <td width="80%"><strong>공급가액:</strong></td>
                            <td width="20%" id="supply-amount">0원</td>
                        </tr>
                        <tr>
                            <td><strong>부가세(10%):</strong></td>
                            <td id="tax-amount">0원</td>
                        </tr>
                        <tr>
                            <td><strong>총 금액(부가세 포함):</strong></td>
                            <td id="total-with-tax">0원</td>
                        </tr>
                    </table>
                </div>
                
                <div class="account-info">
                    <p>입금 계좌 정보</p>
                    <p class="account-number">기업은행 093-149055-04-014 (최성현)</p>
                </div>
                
                <div class="stamp">
                    <p>감사합니다.</p>
                </div>
            </div>
        </div>
        
        <button class="save-button" onclick="saveToPrint()">저장하기</button>
    </div>

    <script>
        // 현재 날짜를 입력 필드의 기본값으로 설정
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const formattedDate = today.toISOString().slice(0, 10); // YYYY-MM-DD 형식
            document.getElementById('date-input').value = formattedDate;
        });
        
        // 전체 항목 선택/해제 기능
        function selectAllItems(checked) {
            // 출장비 체크박스
            document.getElementById("visit-check").checked = checked;
            
            // 모든 메인 카테고리 체크박스
            const categories = ['cpu', 'mb', 'ram', 'psu', 'gpu'];
            
            categories.forEach(cat => {
                const mainCheckbox = document.getElementById(`${cat}-check`);
                mainCheckbox.checked = checked;
                
                // 서브 항목들 체크/언체크
                checkAllSubItems(`${cat}-items`, checked);
                
                // 세부 항목 표시/숨김
                const details = document.getElementById(`${cat}-details`);
                if (checked) {
                    details.style.display = "block";
                } else {
                    details.style.display = "none";
                }
            });
        }
        
        // 저장하기 기능 (현재는 인쇄 다이얼로그를 통해 PDF로 저장 가능)
        function saveToPrint() {
            window.print();
        }
        
        // 세부 항목 토글 기능
        function toggleDetails(id) {
            const details = document.getElementById(id);
            if (details.style.display === "block") {
                details.style.display = "none";
            } else {
                details.style.display = "block";
            }
        }
        
        // 모든 하위 항목 체크/해제 기능
        function checkAllSubItems(itemsName, checked) {
            const items = document.getElementsByName(itemsName);
            for (const item of items) {
                item.checked = checked;
            }
        }
        
        // 날짜 포맷 함수 (YYYY-MM-DD를 YYYY년 MM월 DD일로 변환)
        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            return `${year}년 ${month}월 ${day}일`;
        }
        
        // 점검 내역서 생성 함수
        function generateReport() {
            // 테이블 내용 초기화
            const tbody = document.getElementById("report-items-body");
            tbody.innerHTML = "";
            
            // 입력 필드에서 고객명 가져오기
            const customerName = document.getElementById("customer-input").value.trim() || "홍길동";
            document.getElementById("customer-name").textContent = customerName;
            
            // 입력 필드에서 날짜 가져오기
            const dateInput = document.getElementById("date-input").value;
            const formattedDate = dateInput ? formatDate(dateInput) : formatDate(new Date().toISOString().slice(0, 10));
            document.getElementById("current-date").textContent = formattedDate;
            
            let totalAmount = 0;
            let hasItems = false;
            let itemCount = 0; // 항목 수를 추적
            
            // 출장비 추가
            if (document.getElementById("visit-check").checked) {
                addItemToReport("출장비", "현장 방문 서비스", 20000, tbody);
                totalAmount += 20000;
                hasItems = true;
                itemCount++;
            }
            
            // 각 하드웨어 카테고리 체크 여부 확인
            const categories = [
                { id: "cpu-check", name: "CPU Performance Check", itemsName: "cpu-items", price: 10000, details: getDetailItems("cpu-items") },
                { id: "mb-check", name: "Motherboard Diagnostics", itemsName: "mb-items", price: 10000, details: getDetailItems("mb-items") },
                { id: "ram-check", name: "Memory (RAM) Testing", itemsName: "ram-items", price: 10000, details: getDetailItems("ram-items") },
                { id: "psu-check", name: "Power Supply Unit Check", itemsName: "psu-items", price: 10000, details: getDetailItems("psu-items") },
                { id: "gpu-check", name: "Graphics & Display Output Testing", itemsName: "gpu-items", price: 10000, details: getDetailItems("gpu-items") }
            ];
            
            for (const category of categories) {
                if (document.getElementById(category.id).checked) {
                    addCategoryToReport(category.name, category.price, category.details, tbody);
                    totalAmount += category.price;
                    hasItems = true;
                    itemCount++;
                }
            }
            
            // 빈 공간 조정
            adjustEmptySpace(itemCount);
            
            // 공급가액, 부가세, 총액(세금포함) 계산
            const supplyAmount = totalAmount;
            const taxAmount = Math.round(totalAmount * 0.1);
            const totalWithTax = supplyAmount + taxAmount;
            
            document.getElementById("supply-amount").textContent = supplyAmount.toLocaleString() + "원";
            document.getElementById("tax-amount").textContent = taxAmount.toLocaleString() + "원";
            document.getElementById("total-with-tax").textContent = totalWithTax.toLocaleString() + "원";
            
            // 점검 내역서 표시
            if (hasItems) {
                document.getElementById("report-result").style.display = "block";
            } else {
                alert("적어도 하나의 항목을 선택해주세요.");
            }
            
            // 함수: 세부 항목 가져오기
            function getDetailItems(itemsName) {
                const items = document.getElementsByName(itemsName);
                const details = [];
                
                items.forEach(item => {
                    if (item.checked) {
                        details.push(item.parentElement.textContent.split('(')[0].trim());
                    }
                });
                
                return details;
            }
            
            // 함수: 카테고리 항목 추가
            function addCategoryToReport(category, price, details, tbody) {
                const tr = document.createElement("tr");
                
                // 카테고리 셀
                const tdCategory = document.createElement("td");
                tdCategory.textContent = category;
                tdCategory.style.verticalAlign = "middle"; // 수직 가운데 정렬 추가
                tr.appendChild(tdCategory);
                
                // 세부 내용 셀
                const tdDesc = document.createElement("td");
                if (details && details.length > 0) {
                    tdDesc.innerHTML = details.map(detail => 
                        `<span class="detail-item">- ${detail}</span>`
                    ).join('');
                } else {
                    tdDesc.textContent = "전체 점검";
                }
                tdDesc.style.verticalAlign = "middle"; // 수직 가운데 정렬 추가
                tr.appendChild(tdDesc);
                
                // 금액 셀
                const tdAmount = document.createElement("td");
                tdAmount.textContent = price.toLocaleString() + "원";
                tdAmount.style.verticalAlign = "middle"; // 수직 가운데 정렬 추가
                tr.appendChild(tdAmount);
                
                tbody.appendChild(tr);
            }
            
            // 함수: 일반 항목 추가 (출장비용)
            function addItemToReport(category, description, price, tbody) {
                const tr = document.createElement("tr");
                
                // 카테고리 셀
                const tdCategory = document.createElement("td");
                tdCategory.textContent = category;
                tdCategory.style.verticalAlign = "middle"; // 수직 가운데 정렬 추가
                tr.appendChild(tdCategory);
                
                // 세부 내용 셀
                const tdDesc = document.createElement("td");
                tdDesc.textContent = description;
                tdDesc.style.verticalAlign = "middle"; // 수직 가운데 정렬 추가
                tr.appendChild(tdDesc);
                
                // 금액 셀
                const tdAmount = document.createElement("td");
                tdAmount.textContent = price.toLocaleString() + "원";
                tdAmount.style.verticalAlign = "middle"; // 수직 가운데 정렬 추가
                tr.appendChild(tdAmount);
                
                tbody.appendChild(tr);
            }
        }
        
        // 빈 공간 조정 함수
        function adjustEmptySpace(itemCount) {
            const emptySpace = document.getElementById('empty-space');
            
            // 항목 수에 따라 빈 공간 높이 조정
            if (itemCount <= 1) {
                emptySpace.style.minHeight = '180px';
            } else if (itemCount <= 2) {
                emptySpace.style.minHeight = '150px';
            } else if (itemCount <= 3) {
                emptySpace.style.minHeight = '120px';
            } else if (itemCount <= 4) {
                emptySpace.style.minHeight = '90px';
            } else if (itemCount <= 5) {
                emptySpace.style.minHeight = '60px';
            } else {
                emptySpace.style.minHeight = '30px';
            }
        }
        
        // 초기화 - 모든 세부항목 체크박스에 하위 항목 하나라도 체크하면 상위 체크박스도 체크
        document.addEventListener('DOMContentLoaded', function() {
            const categories = ['cpu', 'mb', 'ram', 'psu', 'gpu'];
            
            categories.forEach(cat => {
                const items = document.getElementsByName(`${cat}-items`);
                
                items.forEach(item => {
                    item.addEventListener('change', function() {
                        const mainCheckbox = document.getElementById(`${cat}-check`);
                        
                        // 하위 항목이 하나라도 체크되어 있으면 상위 체크박스 체크
                        let anyChecked = false;
                        for (const subItem of items) {
                            if (subItem.checked) {
                                anyChecked = true;
                                break;
                            }
                        }
                        
                        mainCheckbox.checked = anyChecked;
                        
                        // 상위 체크박스가 체크되면 세부 항목 표시
                        if (anyChecked && document.getElementById(`${cat}-details`).style.display !== "block") {
                            toggleDetails(`${cat}-details`);
                        }
                    });
                });
            });
        });
    </script>
</body>
</html>
